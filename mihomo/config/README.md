# Mihomo 配置文件集合

> **项目地址**: [666OS/YYDS](https://github.com/666OS/YYDS)  
> **更新时间**: 2025 年 12 月 6 日  
> **作者**: YYDS666  
> **Telegram 频道**: https://t.me/Pinched666

## 📋 目录

- [配置文件概览](#配置文件概览)
- [配置文件详解](#配置文件详解)
  - [MihomoPro - 高大全版](#mihomopro---高大全版)
  - [OneSmartPro - 一键智能代理](#onesmartpro---一键智能代理)
  - [OneSmart - 极简版](#onesmart---极简版)
  - [OneTouch - 一键连](#onetouch---一键连)
- [共同功能特性](#共同功能特性)
- [使用指南](#使用指南)
- [配置对比](#配置对比)
- [常见问题](#常见问题)

## 📦 配置文件概览

本目录包含 4 个不同复杂度和应用场景的 Mihomo 配置文件，从功能全面的专业版到极简的一键连配置，满足不同用户需求：

| 配置文件 | 版本 | 复杂度 | 适用场景 | 文件大小 |
|---------|------|--------|---------|----------|
| `MihomoPro.yaml` | v6.1.0 | ⭐⭐⭐⭐⭐ | 专业用户，需要全功能支持 | 24.8 KB |
| `OneSmartPro.yaml` | v1.3.0 | ⭐⭐⭐⭐ | 高级用户，智能代理 + 多端口 | 21.9 KB |
| `OneSmart.yaml` | v1.3.0 | ⭐⭐⭐ | 普通用户，智能代理极简版 | 13.4 KB |
| `OneTouch.yaml` | v3.9.0 | ⭐⭐ | 新手用户，一键连纯净版 | 13.4 KB |

## 📖 配置文件详解

### MihomoPro - 高大全版

**文件名**: `MihomoPro.yaml`  
**版本**: v6.1.0  
**定位**: 功能最全面的专业级配置

#### 核心特性

- **策略组类型丰富**: 支持 Fallback（故障转移）、Load-Balance（负载均衡-散列/轮询）、URL-Test（自动测速）
- **规则集最完整**: 包含广告拦截、追踪拦截、QUIC 阻止、抖快书定位、下载直连等高级规则
- **最多的策略组**: 
  - 主要策略组：默认代理、故障转移、国外/国内流量、兜底流量
  - 功能策略组：网络测试、抖快书定位
  - 媒体服务：Emby、YouTube、Netflix、国际媒体、新闻媒体
  - 社交平台：Telegram、Twitter、社交平台
  - 商业服务：人工智能、货币平台、游戏平台、微软/谷歌/苹果服务
  - 地区策略：7 个地区（香港、台湾、狮城、日本、韩国、美国、欧盟），每个地区支持 3 种策略
- **节点选择最灵活**: 每个地区提供自动测速、散列负载均衡、轮询负载均衡三种选择
- **网络优化**: 阻止 QUIC 协议，强制使用 HTTPS，提升规则匹配准确性

#### 适用场景

✅ 专业用户需要精细控制不同应用的代理策略  
✅ 需要广告拦截、追踪保护和 QUIC 阻止  
✅ 对不同媒体平台、社交网络有细分代理需求  
✅ 需要下载流量直连优化

---

### OneSmartPro - 一键智能代理

**文件名**: `OneSmartPro.yaml`  
**版本**: v1.3.0  
**定位**: 基于智能算法的高级配置，提供四层架构智能路由

#### 核心特性

- **Smart 智能策略**: 采用 LightGBM 机器学习算法，自动选择最优节点
- **四层架构设计**:
  1. **应用策略层**: Select 手动选择，支持多场景应用优化
  2. **线路特性层**: Fallback 故障转移，按特性优化线路选择（高质量、低延迟、大带宽、低倍率）
  3. **地理策略层**: Smart 智能选择，支持政策权重配置（如 `优:2;中:1;备:0.5`）
  4. **中转服务层**: LoadBalance 负载均衡，提供中转服务提升连通性
- **多端口监听器**:
  - Shadowsocks 监听器：支持远程连接家庭网络（端口 10000）
  - Mixed 监听器：7 个专用端口（50000-50006）对应不同地区，可配置浏览器插件或手机 APP 分地区访问
- **规则集丰富**: 包含广告/追踪拦截、应用分流（AI、Telegram、社交、游戏、加密货币、Emby、流媒体、Apple、Google、Microsoft、Facebook）

#### 适用场景

✅ 高级用户需要智能节点选择，减少手动干预  
✅ 多机场用户，需要按线路质量、延迟、带宽、倍率智能分配  
✅ 需要中转代理提升连通性  
✅ 需要多端口监听器，实现分地区专用代理  
✅ 希望通过权重配置优先使用特定机场

---

### OneSmart - 极简版

**文件名**: `OneSmart.yaml`  
**版本**: v1.3.0  
**定位**: 基于 Smart 智能算法的极简配置

#### 核心特性

- **Smart 智能策略**: 同样采用 LightGBM 算法，自动选择最优节点
- **精简的策略组**:
  - 应用策略层：一键智能、人工智能、社交平台、国际媒体、国外/国内流量、兜底流量
  - 地理策略层：7 个地区智能策略（香港、台湾、日本、狮城、韩国、美国、欧洲）
- **精简的规则集**: 移除了广告拦截、追踪拦截等高级规则，保留核心代理规则
- **保留核心功能**: DNS、TUN、Sniffer、健康检查等核心功能完整保留

#### 适用场景

✅ 普通用户希望使用智能算法但不需要太多策略组  
✅ 配置简洁，易于维护  
✅ 不需要广告拦截等高级功能  
✅ 智能节点选择，减少手动操作

---

### OneTouch - 一键连

**文件名**: `OneTouch.yaml`  
**版本**: v3.9.0  
**定位**: 最简洁的一键连配置，适合新手

#### 核心特性

- **URL-Test + Fallback**: 使用传统的自动测速和故障转移策略
- **极简策略组**:
  - 核心策略：一键连、故障转移
  - 应用分流：人工智能、社交平台、国际媒体
  - 地区自动：7 个地区自动测速策略
- **精简规则集**: 仅保留最必要的代理规则，无广告拦截
- **更多具体流媒体规则**: 包含 YouTube、Spotify、Netflix、Disney、HBO 等独立规则

#### 适用场景

✅ 新手用户，希望配置简单、开箱即用  
✅ 不需要复杂的策略组和规则  
✅ 使用传统的自动测速选择节点  
✅ 流媒体用户，需要对特定平台精细控制

---

## 🎯 共同功能特性

所有配置文件都包含以下共同特性：

### 网络监听

- **HTTP 代理**: 端口 7890
- **SOCKS5 代理**: 端口 7891
- **Redirect 代理**: 端口 7892
- **Mixed 代理**: 端口 7893
- **TProxy 代理**: 端口 7895

### 认证配置

- 用户名/密码认证：`mihomo:yyds666`
- 免认证网段：192.168.1.0/24、192.168.31.0/24、192.168.100.0/24、127.0.0.1/8

### 管理面板

- **控制面板地址**: `127.0.0.1:9090`
- **控制面板密钥**: `yyds666`
- **UI 界面**: Zashboard（自动下载最新版）

### DNS 配置

- **增强模式**: Fake-IP（198.18.0.1/16）
- **默认 DNS**: 119.29.29.29、180.184.1.1、223.5.5.5
- **DoH**: 阿里 DNS、腾讯 DNS
- **IPv6**: 已启用

### TUN 模式

- 默认禁用（可手动开启）
- 协议栈：Mixed
- 自动路由、自动重定向、自动检测接口

### 流量嗅探

- HTTP：80、8080-8880
- TLS：443、8443
- QUIC：443、8443（已阻止 UDP 443，强制使用 HTTPS）

### 地理位置过滤

所有配置支持以下地区的节点筛选（通过正则表达式）：

- 🇭🇰 香港（HK）
- 🇹🇼 台湾（TW）
- 🇸🇬 新加坡（SG）
- 🇯🇵 日本（JP）
- 🇰🇷 韩国（KR）
- 🇺🇸 美国（US）
- 🇪🇺 欧盟（EU）
- 其他地区（OT）

## 🚀 使用指南

### 1. 选择合适的配置文件

根据你的需求和技术水平选择：

```
新手 → OneTouch.yaml
普通用户 → OneSmart.yaml
高级用户 → OneSmartPro.yaml
专业用户 → MihomoPro.yaml
```

### 2. 修改订阅源

所有配置文件都需要修改 `proxy-providers` 部分：

```yaml
proxy-providers:
  # 将下面的 URL 替换为你的机场订阅链接
  优质服务商: {<<: *BaseProvider, url: '你的机场订阅链接', override: {additional-prefix: '[优] '}}
  备用服务商: {<<: *BaseProvider, url: '你的备用订阅链接', override: {additional-prefix: '[备] '}}
```

**OneSmartPro 额外配置**（如需使用中转代理）：

```yaml
  # 如需使用中转代理，取消注释并修改此行
  落地服务商: {<<: *BaseProvider, url: '落地订阅源地址', override: {additional-prefix: '[中] ', dialer-proxy: 中转服务}}
```

### 3. 自定义节点优先级（Smart 智能配置专用）

**OneSmart** 和 **OneSmartPro** 支持政策权重配置：

```yaml
# 在地理策略层，修改 policy-priority
- {name: 香港智能, <<: *BaseSmart, filter: *FilterHK, include-all: true, 
   policy-priority: '优:2;备:0.5',  # 数值越大优先级越高
   icon: https://...}
```

权重说明：
- 默认权重为 `1`
- `优:2;备:0.5` 表示优质服务商节点权重为 2，备用服务商权重为 0.5
- 智能算法会优先选择权重高的节点

### 4. 修改排除节点（可选）

在所有 `Filter` 正则表达式中，可以修改排除关键词：

```yaml
# 例如排除包含 "5x" 的节点
FilterHK: &FilterHK '^(?=.*(?i)(港|🇭🇰|HK|Hong|HKG))(?!.*(排除1|排除2|5x)).*$'
#                                                           ^^^^^^^^^^^^^^^^
#                                                           在此处添加你要排除的关键词
```

### 5. 启动 Mihomo

```bash
# 使用配置文件启动
mihomo -f /path/to/config.yaml
```

### 6. 访问控制面板

浏览器访问：`http://127.0.0.1:9090/ui`  
输入密钥：`yyds666`

## 📊 配置对比

| 特性 | MihomoPro | OneSmartPro | OneSmart | OneTouch |
|-----|-----------|-------------|----------|----------|
| **智能算法** | ❌ | ✅ Smart | ✅ Smart | ❌ |
| **广告拦截** | ✅ | ✅ | ❌ | ❌ |
| **追踪拦截** | ✅ | ✅ | ❌ | ❌ |
| **QUIC 阻止** | ✅ | ✅ | ✅ | ✅ |
| **链式代理** | ❌ | ✅（中转服务） | ❌ | ❌ |
| **负载均衡** | ✅ 散列+轮询 | ✅ 仅中转层 | ❌ | ❌ |
| **故障转移** | ✅ | ✅ | ❌ | ✅ |
| **URL-Test** | ✅ | ❌ | ❌ | ✅ |
| **多端口监听** | ❌ | ✅ 7个+SS | ❌ | ❌ |
| **策略组数量** | 60+ | 30+ | 15+ | 10+ |
| **规则集数量** | 30+ | 25+ | 15+ | 18+ |
| **应用分流细分** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ |
| **配置复杂度** | 高 | 中高 | 中 | 低 |
| **适合人群** | 专业用户 | 高级用户 | 普通用户 | 新手 |

## ❓ 常见问题

### Q1: 如何选择配置文件？

**A**: 根据你的需求：
- 需要最精细的控制 → `MihomoPro.yaml`
- 需要智能算法 + 多端口 → `OneSmartPro.yaml`
- 需要智能算法 + 简洁 → `OneSmart.yaml`
- 需要简单易用 → `OneTouch.yaml`

### Q2: Smart 智能策略和传统 URL-Test 有什么区别？

**A**: 
- **Smart 智能策略**: 使用 LightGBM 机器学习算法，综合考虑延迟、稳定性、历史表现等多个因素，智能选择最优节点
- **URL-Test**: 仅基于单次延迟测试结果选择最快节点，可能不够稳定

### Q3: 如何使用中转代理？

**A**: 仅 `OneSmartPro.yaml` 支持中转代理：
1. 在 `proxy-providers` 中配置落地服务商
2. 在 `中转服务` 策略组中选择中转节点
3. 修改 `落地服务商` 的 `dialer-proxy` 为 `中转服务`

### Q4: 如何使用多端口监听器？

**A**: 仅 `OneSmartPro.yaml` 支持：
1. 配置浏览器代理为 `127.0.0.1:50000`（美国智能）
2. 或配置手机代理为 `[你的电脑IP]:50003`（香港智能）
3. 不同端口对应不同地区，见监听器配置部分

### Q5: 配置文件中的机场订阅链接如何填写?

**A**: 
```yaml
proxy-providers:
  优质服务商: {
    <<: *BaseProvider, 
    url: 'https://your-airport.com/api/v1/client/subscribe?token=xxxxx',
    override: {additional-prefix: '[优] '}
  }
```

将 `url` 后的单引号内容替换为你的机场订阅链接。

### Q6: 如何开启 TUN 模式？

**A**: 修改配置文件中的 TUN 配置：
```yaml
tun:
  enable: true  # 改为 true
```

**注意**: TUN 模式需要管理员权限运行 Mihomo。

### Q7: 权重配置如何理解？

**A**: 以 `policy-priority: '优:2;中:1;备:0.5'` 为例：
- 优质服务商的节点优先级最高（权重 2）
- 中转服务商次之（权重 1）
- 备用服务商最低（权重 0.5）
- Smart 算法会优先从高权重机场选择节点

### Q8: 规则匹配顺序是什么？

**A**: 所有配置遵循相同的匹配顺序：
1. 拦截规则（广告/追踪，仅部分配置）
2. 域名规则（从上到下）
3. IP 规则（从上到下）
4. 兜底规则（MATCH）

### Q9: 如何更新规则集？

**A**: 规则集会每 24 小时（86400 秒）自动更新，无需手动操作。

### Q10: 控制面板无法访问？

**A**: 检查以下几点：
1. Mihomo 是否正常运行
2. 防火墙是否允许 9090 端口
3. 浏览器访问 `http://127.0.0.1:9090/ui` 而非 `https://`
4. 输入密钥 `yyds666`

---

## 📞 支持与反馈

- **项目地址**: https://github.com/666OS/YYDS
- **Telegram 频道**: https://t.me/Pinched666
- **规则仓库**: https://github.com/666OS/rules

---

## 📄 许可证

请遵循项目的开源许可证使用这些配置文件。

---

**最后更新**: 2025 年 12 月 6 日  

---

## 📝 更新日志

### v6.1.0 / v1.3.0 / v3.9.0 (2025-12-06)

- ✨ **新增**: 所有配置文件添加 QUIC 阻止规则，强制使用 HTTPS 提升规则匹配准确性
- ✨ **新增**: MihomoPro 添加 Download 下载规则直连，优化下载速度
- ♻️ **移除**: MihomoPro 移除链式代理功能（中转机、落地机），简化配置
- 📝 **更新**: 所有配置文件版本号统一升级
- 📝 **优化**: README 文档更新至最新版本
